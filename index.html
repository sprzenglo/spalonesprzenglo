<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>wielka księga sprzengla</title>
<link rel="stylesheet" href="style.css">
<style>
body { font-family: 'Times New Roman', Times, serif; background: #f8f8f8; margin:0; }
.header { background: #2908ce; color: white; padding: 20px; text-align:center; font-size:2em; font-weight:bold; }
.contents { max-width:900px; margin:20px auto; background:#fff; border:1px solid #222; padding:20px; }
.category-title { cursor:pointer; font-weight:bold; margin-top:10px; }
.article-list a { display:block; margin:4px 0; text-decoration:underline; color:#010de7; }
.comments { margin-top:40px; border-top:2px solid #222; padding-top:20px; }
.comment { border-bottom:1px solid #ccc; padding:6px; margin-bottom:6px; }
.comment button { font-size:0.8em; margin-left:10px; }
textarea,input { width:300px; margin-top:4px; margin-bottom:4px; padding:4px; }
</style>
</head>
<body>

<div class="header">wielka księga sprzengla</div>

<div class="contents">
  <div class="category">
    <div class="category-title">Zwierzęta ▼</div>
    <div class="article-list">
      <a href="pipotam.html">Pipotam</a>
      <a href="animal1.html">Meowl</a>
      <a href="animal2.html">homik</a>
      <a href="animal3.html">kuc z bronksu</a>
    </div>
  </div>
  <div class="category">
    <div class="category-title">top samochody oat ▼</div>
    <div class="article-list">
      <a href="car1.html">Civic 4th Generation</a>
      <a href="car2.html">Porsche 935</a>
    </div>
  </div>
  
  <!-- WSPÓLNE OKIENKO KOMENTARZY -->
  <div class="comments">
    <h2>Czat / komentarze</h2>
    <div id="comments-container"></div>

    <h3>Dodaj komentarz</h3>
    <input type="text" id="name" placeholder="Twoje imię"><br>
    <textarea id="content" placeholder="Treść komentarza" rows="3"></textarea><br>
    <button onclick="addComment()">Wyślij</button>
  </div>
</div>

<script>
const API_BASE = 'http://localhost:10000'; // Twój backend

async function loadComments() {
  const res = await fetch(`${API_BASE}/comments`);
  const comments = await res.json();
  const container = document.getElementById('comments-container');
  container.innerHTML = comments.map(c => `
    <div class="comment" id="comment-${c._id}">
      <b>${c.name}</b>: ${c.content} <small>${new Date(c.date).toLocaleString()}</small>
      <button onclick="deleteComment('${c._id}')">Usuń</button>
    </div>
  `).join('');
}

async function addComment() {
  const name = document.getElementById('name').value.trim();
  const content = document.getElementById('content').value.trim();
  if(!name || !content) return alert('Podaj imię i treść');
  
  await fetch(`${API_BASE}/comments`, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({name, content})
  });
  
  document.getElementById('name').value='';
  document.getElementById('content').value='';
  loadComments();
}

async function deleteComment(id) {
  const password = prompt('Podaj hasło do usunięcia komentarza:');
  if(!password) return;
  
  const res = await fetch(`${API_BASE}/comments/delete`, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ id, password })
  });
  const data = await res.json();
  if(data.success) loadComments();
  else alert(data.msg || 'Błąd');
}

// inicjalizacja
loadComments();
</script>

</body>
</html>
